<!DOCTYPE html>
<html>

<head>
  <title>Economy</title>

  <!-- Download the vega packages via CDN -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>

  <!-- Import statement of pure.css -->
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css"
    integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Google font import statement -->
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;700;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Oxygen&display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="css/styles.css" media="all">
  <script src="https://d3js.org/d3.v4.min.js"></script>
  </head>

<body>

  <div class="page">

    <!-- first pure group -->
    <div class="pure-g">
      <div class="pure-u-1-1">
        <!-- title -->
        <h1 style="text-align: center;">MacroEconomic data across the world</h1>
        <!-- Map description -->
        <p>Across the world, MacroEconomic has been one of the most interesting topic to be discussed in the politics, news, and so on. For the visualisation, we will look into the visualisation of various type of visualisation charts to have an in-depth understanding in the MacroEconomic data across the world.</p>
      </div>
    </div>

    <!-- Choropleth map -->
    <div class="pure-g">
      <div class="pure-u-1-1">
        <div id="vis1" class="vis-container"></div>
      </div>
    </div>
    <div class="pure-g">
      <div class="pure-u-1-1">
        <!-- Explanation Text of the choropleth map -->
        <p>The choropleth map shown above illustrates the GDP per capita across the world in 2020. By having a careful look at the map, we can see that the countries in the America continent has the highest GDP oer capita while many countries in the Africa continent seems like there are not many countries with a relatively high GDP per capita since the color depicted on the continent is mostly the bright color.</p>
      </div>
    </div>
    <!-- end of the choropleth map section -->

    <!-- Scatter Plot -->
    <div class="pure-g">
      <div class="pure-u-1-1">
        <div id="vis2" class="vis-container"></div>
      </div>
    </div>
    <div class="pure-g">
      <div class="pure-u-1-1">
        <!-- Explanation of the scatter plot -->
        <p>Now, we look into the visuallisation chart above to see the relationshiop between unemployment rate and inflation rate. Although there is not much correlation between inflation rate and unemployment rate, there is a slight positive correlation within the relationship. Russian Federation has the highest inflation rate of 4.47% and the unemployment rate of the country is relatively high as well compared to the countries with similar size of circles (GDP per capita).</p>
      </div>
    </div>
    <!-- end of the scatter plot section -->


    <!-- <div class="pure-g">
      <div class="pure-u-1-2">
        <div id="vis5" class="vis-container"></div>
      </div>
      <div class="pure-u-1-2">
        <div class="description description-right">
          Title of the visualisaiton -->
          <!-- <h2>Contribution To GDP By Industries in U.S. (2020)</h2> -->
          <!-- Description of the data vis -->
          <!-- <p>Furthermore, the visualisation chart shows the number of unemployment during the period by industries in the U.S. Generally, there is an increase of the number of unemployment as the years pass by for all the industries. When we have a close look at the chart, we can see that leisure and hospitality industry is the most stable unemployment rate.</p>        </div> -->
      <!-- </div> -->
    <!-- </div> -->


        <!-- Scatter Plot -->
        <div class="pure-g">
          <div class="pure-u-1-1">
            <div id="vis5" class="vis-container"></div>
          </div>
        </div>
        <div class="pure-g">
          <div class="pure-u-1-1">
            <!-- Explanation of the scatter plot -->
            <p>Now, we look into the visuallisation chart above to see the relationshiop between unemployment rate and inflation rate. Although there is not much correlation between inflation rate and unemployment rate, there is a slight positive correlation within the relationship. Russian Federation has the highest inflation rate of 4.47% and the unemployment rate of the country is relatively high as well compared to the countries with similar size of circles (GDP per capita).</p>
          </div>
        </div>
        <!-- end of the scatter plot section -->

    <!-- Two line plot -->
    <div class="pure-g">
      <div class="pure-u-1-2">
        <div class="description description-right">
          <!-- title of the plot -->
          <h2>GDP, Covid New Cases, Inflation Rate Comparison in U.S.</h2>
          <!-- Explanation of the plot -->
          <p>We can have a closer look at a particular country's MacroEconomic data. We have picked the United States of America. In this visualisation chart, we can see a trend across multiple lines. We can see that there is a fluctuattion during the year 2014 to 2019. Then, after 2019, there is a boost in all of the indicators, which could be attributed to the occurence of COVID-19.</p>
        </div>
      </div>
      <div class="pure-u-1-2">
        <!-- Two line plot visualisation -->
        <div id="vis3" class="vis-container"></div>
      </div>
    </div>
    <!-- End of the two line plot visualisation -->

    <!-- Other data visualisation  -->
    <div class="pure-g">
      <div class="pure-u-1-2">
        <div id="vis4" class="vis-container"></div>
      </div>
      <div class="pure-u-1-2">
        <div class="description description-right">
          <!-- Title of the visualisaiton -->
          <h2>Contribution To GDP By Industries in U.S. (2020)</h2>
          <!-- Description of the data vis -->
          <p>Continuing from the closer look at the MacroEconomic data in the U.S, we can see the visualisation chart that illustrates the contribution to GDP by industries. From this chart, we can tell that Finance has the highest contribution out of all the industries while Construction has the lowest contribution.</p>
        </div>
      </div>
    </div>
    <!-- end of the vis -->

    
    <!-- vis -->
    <div class="pure-g">
      <div class="pure-u-1-2">
        <div class="description description-right">
          <!-- title of the plot -->
          <h2>Ranking of GDP growth (%) for the selected countries</h2>
          <!-- Explanation of the plot -->
          <p>The visualisation chart shown illustrates the ranking of GDP growth for the chosen countries. As you can see in the chart, India is in the first place of the GDP growth in 2016, then the rank has dropped from the 1st to the 2nd place due to the rise of the rank from United Kingdom in 2020. Also, it is noteworthy to mention that there is a sharp drop of the rank in the U.S from 2019 to 2020.</p>
        </div>
      </div>
      <div class="pure-u-1-2">
        <div id="vis6" class="vis-container"></div>
      </div>
    </div>
    <!-- End of the visualisation -->

    <div class="pure-g">
      <div class="pure-u-1-1 small-font">
        <p>This visualisation is created by <a href="https://github.com/daikidev111">Daiki Kubo</a>
      </div>
    </div>
  </div> <!-- end page -->

  <script type="text/javascript">
    var spec_choropleth = "js/choropleth_map.vg.json";
    var spec_bubble_plot = "js/bubble_plot.vg.json";
    var spec_mult_line_chart = "js/line_chart.vg.json";
    var spec_stream_graph = "js/stream_graph.vg.json";
    var spec_bump_chart = "js/bump_chart.vg.json";

    vegaEmbed('#vis1', spec_choropleth, { "actions": false }).then(function (result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
    }).catch(console.error);

    vegaEmbed('#vis2', spec_bubble_plot, { "actions": false }).then(function (result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
    }).catch(console.error);

    vegaEmbed('#vis3', spec_mult_line_chart, { "actions": false }).then(function (result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
    }).catch(console.error);

    vegaEmbed('#vis5', spec_stream_graph, {"actions": false}).then(function(result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
    }).catch(console.error);

    vegaEmbed('#vis6', spec_bump_chart, {"actions": false}).then(function(result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
    }).catch(console.error);


  </script>
  <script>
    const width = 440,
      height = 380,
      chartRadius = height / 2 - 40;
    
    const color = d3.scaleOrdinal(d3.schemeCategory10);
    let svg = d3.select('#vis4').append('svg')
      .attr('width', width)
      .attr('height', height)
      .append('g')
      .attr('transform', 'translate(180,190)');
    
    let tooltip = d3.select('body').append('div')
      .attr('class', 'tooltip');
    
    const PI = Math.PI,
      arcMinRadius = 10,
      arcPadding = 10,
      labelPadding = -5,
      numTicks = 10;
    
    
    d3.csv('https://raw.githubusercontent.com/daikidev111/FIT3179-Assignment2/main/Cleaned_Datasets/industry_gdp_us_2020.csv', (error, data) => {
        let scale = d3.scaleLinear()
            .domain([0, 100])
            .range([0, 2 * PI]);
    
        let ticks = scale.ticks(numTicks).slice(0, -1);
        let keys = data.map((d, i) => d.industry_type);
        //number of arcs
        const numArcs = keys.length;
        const arcWidth = (chartRadius - arcMinRadius - numArcs * arcPadding) / numArcs;
    
        let arc = d3.arc()
            .innerRadius((d, i) => getInnerRadius(i))
            .outerRadius((d, i) => getOuterRadius(i))
            .startAngle(0)
            .endAngle((d, i) => scale(d))
    
        let radialAxis = svg.append('g')
            .attr('class', 'r axis')
            .selectAll('g')
            .data(data)
            .enter().append('g');
    
        // radialAxis.append('circle')
        //     .attr('r', (d, i) => getOuterRadius(i) + arcPadding);
    
        radialAxis.append('text')
            .attr('x', labelPadding)
            .attr('y', (d, i) => -getOuterRadius(i) + arcPadding)
            .text(d => d.industry_type);
    
        let axialAxis = svg.append('g')
            .attr('class', 'a axis')
            .selectAll('g')
            .data(ticks)
            .enter().append('g')
            .attr('transform', d => 'rotate(' + (rad2deg(scale(d)) - 90) + ')');
    
        // axialAxis.append('line')
        //     .attr('x2', chartRadius);
    
        axialAxis.append('text')
            .attr('x', chartRadius + 10)
            .style('text-anchor', d => (scale(d) >= PI && scale(d) < 2 * PI ? 'end' : null))
            .attr('transform', d => 'rotate(' + (90 - rad2deg(scale(d))) + ',' + (chartRadius + 10) + ',0)')
            .text(d => d);
    
        //data arcs
        let arcs = svg.append('g')
            .attr('class', 'data')
            .selectAll('path')
            .data(data)
            .enter().append('path')
            .attr('class', 'arc')
            .style('fill', (d, i) => color(i))
    
        arcs.transition()
            .delay((d, i) => i * 200)
            .duration(1000)
            .attrTween('d', arcTween);
    
        arcs.on('mousemove', showTooltip)
        arcs.on('mouseout', hideTooltip)
    
    
        function arcTween(d, i) {
            let interpolate = d3.interpolate(0, d.gdp_percentage);
            return t => arc(interpolate(t), i);
        }
    
        function showTooltip(data, index) {
            tooltip.style('left', (d3.event.pageX + 10) + 'px')
            .style('top', (d3.event.pageY - 25) + 'px')
            .style('display', 'inline-block')
            .html("GDP Percentage: " + data.gdp_percentage + "%" + "</br>&emsp; &emsp; &emsp; Industry: " + data.industry_type)        
        }
    
        function hideTooltip() {
            tooltip.style('display', 'none');
        }
    
        function rad2deg(angle) {
            return angle * 180 / PI;
        }
    
        function getInnerRadius(index) {
            return arcMinRadius + (numArcs - (index + 1)) * (arcWidth + arcPadding);
        }
    
        function getOuterRadius(index) {
            return getInnerRadius(index) + arcWidth;
        }
    });
    </script>
</body>

</html>